### IP地址

**1、IP地址基本概念**

IP 地址在网络层将不同的物理网络地址统一到了全球唯一的 IP 地址上（屏蔽物理网络差异），是唯一标识互联网上计算机的逻辑地址（相当于手机号码，可以通过唯一的手机号码找到手机），所以 IP 地址也被称为互联网地址。

**2、IP地址格式**

我们目前常用的 IPv4 中规定，IP 地址长度为32位二进制，在表示时，一般将32位地址拆分为4个8位二进制，再转为4个十进制数表示，每个数字之间用点隔开，如127.0.0.1（本地回环地址），这种描述方式被称为“点-数表示法”。 
**IP地址层次：**分为网络号和主机号两个层次。网络号表示主机所属网络，主机号表示主机本身。网络号与主机号的位数与 IP 地址分类有关。

**3、IP地址分配** 

IP 地址分配的基本原则是：要为同一网络（子网、网段）内不同主机分配相同的网络号，不同的主机号。

**4、IP地址常见分类**

![](https://img-1256179949.cos.ap-shanghai.myqcloud.com/18-5-6-12053394.jpg)

![](https://img-1256179949.cos.ap-shanghai.myqcloud.com/18-5-6-95868407.jpg)



A类IP地址：

> 一个 A 类 IP 地址由1字节的网络地址和3字节主机地址组成，网络地址的**最高位必须是“0”**， 地址范围从`1.0.0.0` 到`126.0.0.0`。可用的 A 类网络有126个，每个网络能容纳1亿多个主机。PS： `127.0.0.1`为本地回环地址。

B类IP地址：

> 一个 B 类 IP 地址由2个字节的网络地址和2个字节的主机地址组成，网络地址的**最高位必须是“10”**，地址范围从`128.0.0.0`到`191.255.255.255`。可用的 B 类网络有16382个，每个网络能容纳6万多个主机 。 

C类IP地址：

> 一个 C 类 IP 地址由3字节的网络地址和1字节的主机地址组成，网络地址的**最高位必须是“110”**。范围从`192.0.0.0`到`223.255.255.255`。C类网络可达209万余个，每个网络能容纳254个主机。

D类地址：用于多点广播（Multicast）

> D 类 IP 地址**第一个字节以“1110”开始**，它是一个专门保留的地址。它并不指向特定的网络，目前这一类地址被用在多点广播（Multicast）中。多点广播地址用来一次寻址一组计算机，它标识共享同一协议的一组计算机。

E类IP地址：

> E 类 IP 地址是**以“1111”开始**，为将来使用保留。他的第一字节的范围是240~255，主要用于 Internet 试验和开发。PS：其中`240.0.0.0~255.255.255.254`作为保留地址，`255.255.255.255`作为广播地址。
>

**5、特殊的IP地址**

**受限的广播地址：**32位全“1”的 IP 地址，只能做目的地址，用于向本网内部所有主机发送数据包（路由器拒绝向外网发送广播，隔离数据包在本网内）。

**直接广播地址：**网络号全“1”，只能作目的地址，用于向目标网内所有主机发送数据包（路由器接受向外网转发数据包，意为广播在全网有效），如 C 类 IP 所有主机`255.255.255.主机号`、B 类 IP 所有主机`255.255.主机号`。

**本网络本主机地址：**32位全零的 IP 地址对应于当前主机，只能做源地址。

**本网特定主机地址：**网络号全零的 IP 地址表示本网络内的特定主机（路由器拒绝目的地址为本网特定主机的数据包，意为只能向本网内特定主机发送数据包），只能做目的地址。

**环回地址：**就是网络 ID 为127的 IP 地址，用于一台主机的客户端与服务器端通过 TCP\IP 进行通信或者本机进程间通信，一般在自己的主机上进行软件开发测试时候会用到的 localhost(127.0.0.1) 就是环回地址。

在 IP 地址3种主要类型里，各保留了3个区域作为**私有地址**，其地址范围如下：

> A类地址：10.0.0.0～10.255.255.255 
> B类地址：172.16.0.0～172.31.255.255 
> C类地址：192.168.0.0～192.168.255.255

### 子网掩码

上面我们说到 IP 地址分为网络号与主机号，但是路由如何区分网络号与主机号呢？就需要通过子网掩码。子网掩码必须与 IP 地址结合使用，A、B、C类的子网掩码分别为`255.0.0.0`，`255.255.0.0`与`255.255.255.0`（网络号字节为255，主机号字节为0）。

以 C 类 IP 地址`192.168.1.2`为例使用子网掩码划分网络号与主机号。

![](https://img-1256179949.cos.ap-shanghai.myqcloud.com/18-5-6-49311226.jpg)



子网掩码还可以用来将网络划分为更小的子网，将 IP 的两极结构扩充成三级结构，节约地址空间，减轻路由器负担。

**表示方式：**

子网掩码用于划分那些 IP 属于同一个子网, 一般的表示形式，如：`172.20.100.52/26`

首先这是个 B 类地址, 这个地址表示他的子网掩码是 26, 26 代表的意思子网掩码前 26 位全为 1, 即为 `11111111.11111111.11111111.11000000`, 化为整数形式则是 `255.255.255.192`

那么, 如何确定子网内的主机呢？

> IP 地址: `172 . 20 . 100 . 52` ( `10101100 . 00010100 . 01100100 . 00110100` )
> 子网掩码: `255 . 255 . 255 . 192` ( `11111111 . 11111111 . 11111111 . 11000000`)
> 网络地址: `172 . 20 . 100 . 0` ( `10101100 . 00010100 . 01100100 . 00000000` )

实际上网络地址的计算就是用**二进制的 IP 地址"与上"二进制的子网掩码**，那么最后得出了网络地址，网络地址中与子网掩中为 0 对应的位即为可变化的子网内主机 ip 的位，所以对于 `172.20.100.52/26` 来说，他的子网的主机应该包括了

`172.20.100.0` (10101100.00010100.01100100.00000000) ~ `172.20.100.63`(10101100.00010100.01100100.00111111)

前面提到过默认情况下 B 类地址的网络标识位应该是 16 位, 那么上面提到的 172.20.100.52/26 却有 26 位是为什么呢？

这是因为默认情况下的固定了网络标识位，也就固定了某个子网的主机数，这样很有可能会造成 ip 资源的浪费, 也许你并不需要这么大的子网。例如 B 类地址的子网包括了 65534 台主机，C 类地址只有 254 台主机，而你的子网却可能是 500 台主机。这样，如果可以自定义子网掩码的长度，也就是自定义网络标识位的长度，则可以更有效的利用 ip 资源来构成子网。这种采用任意长度切割 IP 地址子网的方式叫 **CIDR**，意为 "**无类型域间选路**"。

### 小结

实际上，一个地址是什么类型的地址仅需要通过地址的前几位去判断就可以了，与子网掩码并没有关系。一个 IP 的子网掩码是多少，则是需要通过 ISP 去向区域互联网注册管理机构申请 CIDR 地址块，也就是说一次性会申请一个段的 IP，而同时也确定了这些 IP 的子网掩码。换句话说，并不可能会同时存在 172.20.100.52/26 和 172.20.100.52/25 两个 IP 相同，子网掩码却不同的地址。



**延伸阅读：**

- 视频：[IPv6真的要来了？邬贺铨说这是中国的新机会](http://www.wicwuzhen.cn/web17/news/jzfu/talks/201712/t20171201_5888756.shtml)







